import numpy as np

blosum62_str = """
   A  C  D  E  F  G  H  I  K  L  M  N  P  Q  R  S  T  V  W  Y
A  4  0 -2 -1 -2  0 -2 -1 -1 -1 -1 -2 -1 -1 -1  1  0  0 -3 -2
C  0  9 -3 -4 -2 -3 -3 -1 -3 -1 -1 -3 -3 -3 -3 -1 -1 -1 -2 -2
D -2 -3  6  2 -3 -1 -1 -3 -1 -4 -3  1 -1  0 -2  0 -1 -3 -4 -3
E -1 -4  2  5 -3 -2  0 -3  1 -3 -2  0 -1  2  0  0 -1 -2 -3 -2
F -2 -2 -3 -3  6 -3 -1  0 -3  0  0 -3 -4 -3 -3 -2 -2 -1  1  3
G  0 -3 -1 -2 -3  6 -2 -4 -2 -4 -3  0 -2 -2 -2  0 -2 -3 -2 -3
H -2 -3 -1  0 -1 -2  8 -3 -1 -3 -2  1 -2  0  0 -1 -2 -3 -2  2
I -1 -1 -3 -3  0 -4 -3  4 -3  2  1 -3 -3 -3 -3 -2 -1  3 -3 -1
K -1 -3 -1  1 -3 -2 -1 -3  5 -2 -1  0 -1  1  2  0 -1 -2 -3 -2
L -1 -1 -4 -3  0 -4 -3  2 -2  4  2 -3 -3 -2 -2 -2 -1  1 -2 -1
M -1 -1 -3 -2  0 -3 -2  1 -1  2  5 -2 -2  0 -1 -1 -1  1 -1 -1
N -2 -3  1  0 -3  0  1 -3  0 -3 -2  6 -2  0  0  1  0 -3 -4 -2
P -1 -3 -1 -1 -4 -2 -2 -3 -1 -3 -2 -2  7 -1 -2 -1 -1 -2 -4 -3
Q -1 -3  0  2 -3 -2  0 -3  1 -2  0  0 -1  5  1  0 -1 -2 -2 -1
R -1 -3 -2  0 -3 -2  0 -3  2 -2 -1  0 -2  1  5 -1 -1 -3 -3 -2
S  1 -1  0  0 -2  0 -1 -2  0 -2 -1  1 -1  0 -1  4  1 -2 -3 -2
T  0 -1 -1 -1 -2 -2 -2 -1 -1 -1 -1  0 -1 -1 -1  1  5  0 -2 -2
V  0 -1 -3 -2 -1 -3 -3  3 -2  1  1 -3 -2 -2 -3 -2  0  4 -3 -1
W -3 -2 -4 -3  1 -2 -2 -3 -3 -2 -1 -4 -4 -2 -3 -3 -2 -3 11  2
Y -2 -2 -3 -2  3 -3  2 -1 -2 -1 -1 -2 -3 -1 -2 -2 -2 -1  2  7
"""

# Parse BLOSUM62 matrix
blosum62 = {}
rows = blosum62_str.strip().split('\n')
aas = rows[0].split()
for line in rows[1:]:
    items = line.split()
    a = items[0]
    for b, score in zip(aas, items[1:]):
        blosum62[(a,b)] = int(score)

gap_penalty = 5

def NWScore(v, w):
    """Calcula a última coluna da matriz de alinhamento global para v x w em espaço linear"""
    prev = [-gap_penalty * i for i in range(len(v)+1)]
    for j in range(1, len(w)+1):
        current = [0]*(len(v)+1)
        current[0] = -gap_penalty * j
        for i in range(1, len(v)+1):
            match = prev[i-1] + blosum62[(v[i-1], w[j-1])]
            delete = prev[i] - gap_penalty
            insert = current[i-1] - gap_penalty
            current[i] = max(match, delete, insert)
        prev = current
    return prev

def Hirschberg(v, w):
    """Retorna alinhamento ótimo global entre v e w usando algoritmo de Hirschberg"""

    if len(v) == 0:
        return '-'*len(w), w
    if len(w) == 0:
        return v, '-'*len(v)
    if len(v) == 1 or len(w) == 1:
        # Caso base simples: podemos alinhar com Needleman-Wunsch normal para sequências pequenas
        return NeedlemanWunsch(v, w)

    mid = len(w)//2
    score_l = NWScore(v, w[:mid])
    score_r = NWScore(v[::-1], w[mid:][::-1])

    max_i = 0
    max_score = score_l[0] + score_r[len(v)-0]
    for i in range(1, len(v)+1):
        score = score_l[i] + score_r[len(v)-i]
        if score > max_score:
            max_score = score
            max_i = i

    left_alignment = Hirschberg(v[:max_i], w[:mid])
    right_alignment = Hirschberg(v[max_i:], w[mid:])

    return left_alignment[0] + right_alignment[0], left_alignment[1] + right_alignment[1]

def NeedlemanWunsch(v, w):
    """Alinhamento NW tradicional para casos pequenos (usado na base da recursão)"""
    n = len(v)
    m = len(w)
    score = np.zeros((n+1,m+1), dtype=int)
    for i in range(1, n+1):
        score[i][0] = score[i-1][0] - gap_penalty
    for j in range(1, m+1):
        score[0][j] = score[0][j-1] - gap_penalty

    for i in range(1, n+1):
        for j in range(1, m+1):
            match = score[i-1][j-1] + blosum62[(v[i-1], w[j-1])]
            delete = score[i-1][j] - gap_penalty
            insert = score[i][j-1] - gap_penalty
            score[i][j] = max(match, delete, insert)

    # traceback
    aligned_v = []
    aligned_w = []
    i, j = n, m
    while i > 0 and j > 0:
        if score[i][j] == score[i-1][j-1] + blosum62[(v[i-1], w[j-1])]:
            aligned_v.append(v[i-1])
            aligned_w.append(w[j-1])
            i -= 1
            j -= 1
        elif score[i][j] == score[i-1][j] - gap_penalty:
            aligned_v.append(v[i-1])
            aligned_w.append('-')
            i -= 1
        else:
            aligned_v.append('-')
            aligned_w.append(w[j-1])
            j -= 1
    while i > 0:
        aligned_v.append(v[i-1])
        aligned_w.append('-')
        i -= 1
    while j > 0:
        aligned_v.append('-')
        aligned_w.append(w[j-1])
        j -= 1

    return ''.join(reversed(aligned_v)), ''.join(reversed(aligned_w))

def score_alignment(v_al, w_al):
    score = 0
    for a,b in zip(v_al, w_al):
        if a == '-' or b == '-':
            score -= gap_penalty
        else:
            score += blosum62[(a,b)]
    return score

# Testando:

v = "CKCLEEFDEPIVEWYPEQNAITEWIRWEIHHESIRRLFKRKREWFLYRKIHLYEGKEDECVDIRWVWWRYCEYFLLNRIQMFMRDTWLKRHTEKTIGCSDVDKPLDADYLYMHWTRLCVCKTLMGVSSSEYIAAIYNEHECQHHQLYEGFMMWPIQFGLWYICYPWFPKPPQCAAPQHCIPSQYGMDRLFWKMFECNWILRNDPWMCNDIAACGMCYHDQCCGHGYMIVYIVFVYMDPFAEDWFWTQYQQEMCTYESMMQHTGGQMVHQMIVNQNMGVLAWPKKTTESRYASDDIPMRENYCTYEILRFPGVVETAAIYAGTIITYFASTWSTMKHPEHYQDEQGLEPSVMCWDSVENWYILYCNQWERWILHRYNGTLEWCSTIYKSINEMLARVNEVYTTSYPIGHWGTRCREQMYKNHKSCWWETGCWDYNCIFMAEKRLGYLWPKKGEDKEAMHLFKERQHIYKYEPSWWRWHGAKCWSVEDKNGWLDCELAIHCRCGVESTDYYMHSNECVLGDGILETSNNVVMLNIIMTDNQKNFCRSDIYFEMPSLQGEIHALAATPQCCSDCLLLNFFYTNTLWLYHPKGSNIMHDYCTLRKCRKAKIDGTHMMSDCTCIGTYFRAVRYDCMKRGGYATHFRGVAWDKPMLGRWWRVYMNWGGKSTVVLTCLDGTTLAHNIRWAESPETPWNSQDICFVAAAITIDTMNIASWGWKPLQNGEVAQDLANPRRTAWHLMANRAHTDRVIEEFRSVSVYSASQNCIPPSWASPLCPVWNNREWSDWRTWKEFWPEHWMFSMDTKYYMVRICEGYHINWHCCWKLRIPTPQWGENTRDLFYKAQLAWVWCERGWFNSGKCPSTPLMLVASNEATNGLKCTERPMVHKSSDPAVIAYEMSVINDYSCHAINLQPHSNRHACHQEDPFDNVEGDVWHTWSSLEPMWNKYKEEEQEECAFGATMYGFTINYYELIGNWKAPYPWFCFNQVEFSEFPQMQETLNKNLCINAGRPEHLRQIQIGMEYCQYTHVKKMMWATYAMPQCDAMHAYTMKTHNDANTTRKRHKSCYGDEWEAYPQNQHCNWDSPDSLEGIAHWNIVYMCQSMTWAILWFNSKQNGHAQTSLGEERKQGLHTPRLGYCVIVKTLKTLEGLSVRTSFMWYGIKQWTHWNRSTMYVDYHKESVAMMTSEIVDTPYKDWGWMRIPSMKAHRGSADNAPQGTHKVYMNSHASMGRRHFFPWRMGYDNVHCQGHHCPSVTLIKNLQNTDHAAEPDPYQRWYPQPNFDTIHSWFHFFQNHQHHIGIFHSIWKKQNNVDFDHWYPSSNLRYREQQNCTYEWWITFAKCGKIYYNMDIGFVRMLCYYQQTTGPNHVRNKCPRWIAMCQDQPLKMEGNGQDPMVYFLDSYRQPLSFLHNIEPWKCNNRPFPCEQAFNLVWNGRNLYQEVEMQLQANQEDRTSMWGVWQMQPIFKDAKKGIEKDVTFLNFCPMPYVAWPNLLCHCCKFTVSNKHQYGLIMWPCAWHWHTDWHYYGAAIIHGWLRNQTQELAIFPDCTMDIMKGCKDFFFCNADARNCKHIHCWNNLVQVDSKKHDGKPSARRTLCEMYGTWSEQVNANDHCRRNIQGLAGTNGVTFGSQNGCASQCCFGPIKFTSHMQHYASCCHQIYSDPIMKEIFYADQNKIHKNCNPIVKWGNDQFNPWAGTQMYITFNVAFLKTGGLAIVPDPRFWNKRGSTIMSGDFIQNYQMCYRQLGTPYRGIPGHGQYCKWAYVCDPRVYKVDDQQEFGCKFGMRKWCQPWPYNANERTAKCNVAASQVVWDAYYTATDVTGVGWSKLCTQDFNCKAYLAAIGTIGIGHHDNMYHFWVCRRTHANCWCPSCMPRARTSMSWPSPDMIRQYWYTKLNFQIFESSNALSIKYRQLMYHTRVWIQEYYAMSDTEKRGYQSTCDPMYGTIPHPTTEIGRQIDARLLHYLFMHLKRYNMMGTDPESEWGWWGTMQVWAIFPNQTWNEAFELEQKWMQIYCSSFLARDMCYFRGHNTAWDDWCICETTKTGVHPIIHLCGTAVYKLHYWCDSLNFQNMFCADDCQQAWKCWGMRKRMSCEQDKRGKEMNVTVTWNGRPKHNWRQPITWNKWSPMILLCNKMAQACEWYNDPYYMKKCRQGFLSMRIGQAPYPYPHDCADGWEVVLMFEADVHGNLVQNCFKPNWAHCAYPSYNWKYDVHEWSMGIPGPFEMMGREWQWWYARDTGRDKNPRNWIVSGQSVWIYIGNGIEIQSTIMPTIPCGRHLRTDILFHEYYYPFYITACNEGDILDSDNWHIMKHHQMNCGFIASPSIPHKYCYGDALARITQMVGQCWPITMINFRACMERMFEHDGRGQWARHSEQSLDEQKCKGFINPFMHTCYIVYHKLKFMHVTFVARENNKSRIPRKYWYPHNYYYGMCYYAGHDSLLYAKVIGNWMCMHDLFNWNYANCKWGCHTGCQLMDVIQDCARLYLMMFDISISTKVDNWFTTFLDFSYVLPLAWKQPFRMVICTGNLYTMEHFWYTSHVCLCWHVHPVRRQDEVSQLWTLVPRPHNGICWPRDAMLPPRCVVTNHDNSAINVWAIRGKTHEMRVNCQLRKSMGPPKHLHMRHEATMHVTYEFGFNMLWFSHWYEEDNFREMNTMWFHHLDNAPAVPGEARQQYGCQYGFIPTGVWKFACLKVLYQVPTTEKMLDMHGIRVQEAGGTSWEFCRLHAKHDNTLVPWPTQYDEDWWTGHWVRCIERQFDNLLDRWISMSFWTCGGAFAFSLMSSNRITFNQNYSLFNAAHAATIDYFQAINYSCIQRVGCRQMFVNWFCFDAPKSMVACALFYWINKSVCNGKWINQLDDTNTPGYMQCPHNINSWRCQHGDWFPWEAVDGKCWHQDDRERFQSCRIIAIPRDRLACDHIEDSHPEDANWAFQNREWNTRGCLARTKYWSFSHIWEFRLPRVGCRWRAEMIEWDRTYTAQTEDWKNGDVPGVSLSPGNDLLSQVSGDMHKINLPWCKEFQIAHPPGERMYQGCEFTGAVCNVGMMMPNKLKICPPSPFHIDSWVLACKHFHIFCEDYYWDLGGTKCNVTKFLHKIMELMAYHQMDHMESAGEFTVFHMGVGPWRGVGYNMRGIRDFYWFPSMGEDKVKYWLPGVKTCVVDHRHYDQHYKLNNMIDVVDHKHQMRDWMAPHVLQMLDPALCLCFDPKKVTWEVWGCTVTGQMDMHKCCPEQYQTPVPGGSWDNHTKFKPIVILGESYAVWCICQKMIRRTNIQWQKSHGHCLSACGFPIKEWVWRCQFPMHWFCECKANTRRAIWHSRQYCERCKGNMVAAFVWMRPMQMHAADDELYELYAGHSTDDYTRIQGQTLCVMNCHIDGKFDMPCIPGTDWRIWGYDEQERMQCVQMSRFKMTDVIMIKKWNYETRRWFEHFMRMMPNPADIAVPKMNMCQRRYYTLPFHRNCDVFVVQAIFVEAGQKRYVDHAFFELHGEEQGMPHTLRECWQRFFEIISVSHYTIEKFFWGKYDYVHYEYVDSQPPLHPGKWMSIDLPCILCGPPHFYGQGPRGYLPFSYSNLYPELHYCFNDCTFLRMCESYDHEPWRLEGCEANACIRKTCDGYDQIVCWPAIPRQEIAWFAEMQDMRRRCVFYRGWNQVECWYMAEYHMREDHEQWTGGKWWDIYFPKQLRTDYYHQTYNMHPKVFSIYCFLNIDESPMCITNNDLAHHCRTEHREWMTLRQARVEWQCVWRAATVQTFADPTMGRYQFVTCFRHMHNQCFVTACQHTEDKGGLFMARKYWQHSRFCRRADIKRVFDHYQPIGATHWGYEVCQEKAFSHTDREDRENQLSQGFIKYYVRSQITSYLSETPRNSVEMPQQCSESWTNQVGEWYGHKFMNTERMMHLSGHMQWTLCARTNTMGRFCQENDNMYARVKILSAFWAPDYMTHFMISKDYQCGALCGIHIWGLVPAWEHCIKCHSRNHMRHCVDDAIAMIDMWLMIELFKTRPYNHTRGRIAQNLTYCFVWYICRFPYLIASAYNHFMEGMYNYLQNARTMWNMSMQYKIYDTYHTADYHKNYHPPNRSADVYIWPEREGFNVSMRAEIPIWPKMEHENSVDRRAQKWYRVMGDCDFPFVQSWEPGYLEKFGFWDETWDVYAIADKKCCCRHECKGFTKLWIEEEKWMTMPHVMIRTTFIKLGVITWVWGLENYGPEYGLHFKMPDPENSGEDFHCGYMPIGTKVLELIQHCWHHVNDMYKRTDAHPYALSATPQGVQSGGVAYVGRAQNPRAEYGWRWDVRQGIDTNHRRRTCIVYLRGYYTKRRPYHVSPHTRQWWGMFGAASQNYYDLAVSSTANCISRIPHNYSVPLTVPGIQSKMKANTSQEQITDTPVKPVQCDTIAMRDNIMKIHFMAWKERWNIHLDYRWCPRERIMFIEAIKWYFYWYDIRRIWPCHQFWHMNTTLDRRLLAARFDVIETMTVADLGHQWFRDDRNPWNSYMIYIGIEFDSPPTQQTGRAWCTEIRLWKHCIHFLFMIFYGKMHRNLKQFQWMYMYRHWTQANFNEKEWFMYFCCEHSQMHGSKMTLGYAQTFQVQPQGRVRGFLLHAPKWISGYDRKFKGCKYWQPEGPMELYCLHCGVSFELLAKSQTWKMAQDFFFPPTMSMGWPLLPDWQGHGRFWFAGGGEAYYNSEDAKGAIKMCSTMYDANPWWHDYFTRHDLWHLLRMNARWVDYSVEKFMHLRESQNCIIVAYQENITSTPRITPRLHHANRHGFNQFPLLISRSMMLDNFFSFHIKPKWDCAIRCDPRLYPMCQTTRVKEHVFMPGDWNVLGKEQGMGDSWYNLQKRDGILSCFTIHIQKECKHGWVLEFDCPQAPPTLESCTKNSQWDKVSEYPGEACQPDNQKWDYQNVAPWFHHSYFMCEVRDQSNNCVWYPCNPFIRPWTSTQWCSYAYGEKWGTGAWTWSLYKVITNVPSDAFDRQPEKWHVGMNIGYDLMKAEWEAAEYSDARWWPQNHNEVNNVRTPYCLGFCTKNYTDLAHMHICRWMTNHCYGQAWPEVEEWIAVRLLSAIYNYVQAPGCPAYGGLFLSPQEGEEPLSNAGIMTFEGCEQTHIVEFINLDFFSRHICCRMLLINQEHMRAIIYSQCTPNLRQPPHPTCIVLSSKFSSEPALNTRLWKPQEVVFTVSIALCWHSQDQVCIDSHRKEDQASVLFKDCWGHWRCSESENDFFCPWIKWGYWGAMPFHTMYCHDEEKASNYDLKVIVHMHLCTTPFHVFVENSIHPQHRLHRPESHQELPVYGHMYQYFEQERKDNLCTMYCAETMLMGACQVMEKKLYTSLCIKQNWRLCCCDPNKLDTLLADPPVNLWGQTIVWRTINQCTTDGISDQWTFYQNNKYPLKNQEPQAVWDVLMGYFQQCFNPHGCYAMQANVYSRKQGKARIDGPCYPGARLKRICRQEHKHNRLCCMVRHRNDPQVMDRMRKMFCQEPDISVTGHTPAKYDRVAYWIKNNGCFWHCRHSQKATVQSVQRKFCCVATELSNAWHVAQGTDDWLYVLCKAPVTEHRYADEWFTIDAFHYMCQQHGDDVHNDEAAYCEWTVVMEVYEMAMVEPAVIKRCEWAGCRGFHNWWVVSQAITNCLTESIMSWYGTSWRYPQGIFNYHTGMQCPLSNPHNNRDGLPFGICNDCQIAIVCGFNFWYCPPHCFILTLHYTLKISHETSAIGTWCEGPKMNHNNNMQQWAYDTGILEVILEHIGWKISWQCARCGFITQATTNRYMETNKCTWVYGYRWESEVEEAGCNFWQVCAYKNPRRAKMYNIIILRFWWGNRDGWPHTAPRQVCAINHIGCGMWCHWDNCYQKYVSIWQDERLCCNDLTHIYDMEDITFLINRGDGRCVKQERMPDKRRDRAKECHSDCLWCSYHTSAQPCGCEANQSNYTYHSMQANWACFPRGVPVLVLTFHDMISIDHLLNVFHEIVVNVIYTHSHKANGTQLVPWSVPYALRTMRNHSYNFSVDTVTMHPLQQYTGPQQGLKYSMYGASPLRQAKTNWCRWPNESNGRIWPAILNCECAWNAFLLFSGVNFCSKEARNKAQYRCGSHVTPWSFLNTGYDYVTRVPQNQSDEGPLHQMFTTIVWVYACIDWKNLRRQVYHGSPQVFSWMTNPLQNQKNKNAQTEPYFHGTTQPVKLEDPPWHQCNCIVAGQCANEKKFPEFRVMSMVYKLGEMSLVWRFTLVHQKMQKASSGCLKFNVNWDGFAKIDNASWLMQILPANIHWGFVFYWHYLLQRIPQCMHDRCYSERCRWAVLDSMRLDMETEPIDRFHGMHSVFMQMVYNSVGSRLRIDHNDVRTHLRDSWSLASDGMCQIQGSWMLQYFNAWIWDDHDSWHTIPVFPYEGPNPLAHWNFWHMPNPGRGFRHVYGSRGSLFQSGEQKRHRFHKSSVQSFPNKVWGAKAEKIQLMCPNQWMTLACKVYRKWYTQKLEHDRWNMFNISVICKSRIGDVRIPPWKHHVAGQRGHCNKVYNYVMAVAYTANTITATWMSTYVNQRVKTPFYSGKCDEDLLNAATMHSLWWMGSQHNFWDRLIDWCAWAWAFWCTMLQETPWVTLWNMNMIRFQDSISGRAGGDKFGTPWSVYNTISWFKMLAPTDQRWEQDHAFWTSRRMDRQVVMQQCGLMWIYSAILDNWVDQIYGFKFDNEWVQKWYMQHWCGVRTNNWTQLRAKKEQFDFTDNEMAEGFIKMCSPRECEWWGMPREEKSHCPANYMLAMGMQENHDRYMGQAIQQWYCNQCTSFIYMATCARSEYFNINCVGFSDSECLWTGWEVNVGCCGGKNGIRCMNDHDFPDVGTFGHLMAEMIYMWISMIVWIPQQEHYFCDRPNWESEQALAGYKTQYFPTPNFIKLKCFMDKLSWMDYKFFEKLEHHGEYENHFNVFKFIMNHVQNIVDYVQPAYSCFIEQHASNWDLYSMYRKCLESYHDPAHNWSGPQWIIIATRKYCGDLYHTHHPHAQINMCSDWSSFGFAKVNYDKQQASWHIGRISNFGLHEKILIIPWYVRFMYHAYWFSYNVNRMVWMIWTEQAHSCFGRQDTQEPPLMNVRPDTCHDFMCTVDCLKISMKCVLTDMGQEGLIQAWWFMVFSKVDSTKMGPYDSRERCAHYEHNIYVKCSRSARRYISPDNCCVQHIHCDDCPGLFIIFYAGIAPITMQWRMDAMNKRIHAQKEKQDLNANLQIDNIKADWSGFW"
w = "CKCLEEEDVPIVEWYPEQNAITEFIRFEIHHEWIRTLVKYILFKRKPEWFLYRKIHLECCFIRWVWWRLCEYFLLPRIMMFMRDTWLVRHTEKTICDCIMFDADYLYMHWTRLCVCKTEMGVSSSEYIAIIYNETEFEMWPKVNWWYICYPWFRKPCAAPQHCIPSAYDEKARCYKFECNKLFNIISVEILRNDPAMCNDIANQKKTMCGMRMHDQCCGHGYMVFVYMDPMAEDWFWTMYQQEMCTYESMMPKSYWHCWQHTGGRDFDDHQYGMNQNMGVLAKKTTESRYASNYCTYEILETAARGECWHMYFWWDRCIRTPEIYWYYAWDQDEQGLEPSVMCWDSVENWYILYCNQWEFWILQCSTIYKSIVPHHPDPCTEVYTTSYPMDEETRGHMHGTRCEQNYNNHHARAIIICDFMAEKRLGYLWKEDKEPGDGTSMLFKERQHIYKYEPAWWRWHGAKCWSVECKNGWLDCEYAITCKCGVESTDYYMHSNECVLGDGILTTSNLNIIMDHANQKNFVRYDNLMCFAGVRWTGQKCIEIYSSENIDFCATAATLLNDFYTNTLWLYHPKGSNIMHDYCTEFYKCRKAKIDGTDMYCRAVRYDCMKRGSHRWFRAAWFAQTTHHPAHPMLGRWWRVYMNWGGKSTVVLNCLDGTTLAHNIRWAESVETPWNSQFIHRYSEHLPFVAAQITIDTMNIAVSGYAIWGWKPFQDFATNWHLRVIEATKEFENVVSVYSASQNCIPQSWFSPLIWIVIKPVWANREWDWEAPKMCWKEFWPEHWDMMNNAIWFSMDTKAMMHRICEGYHINWHCPWKLRIPTPQWGTNTRDLFYKAQLAWVWCERGWANSGKCPLMVVAVIRWKMNEATNGLPAVEAYGMSVINDYNLHWFECHNHAQHQEDPFDNVEWRAFPYDVWHTWSSLELMWNKYKEEEQEEISGWVEAPYPWQATHNKYWVFNQVEAQQHMGSEMQETLNKNLMFVAFESTDWLRRHYLCESRYPRSQIQIGMEYCWYKMMWATYAAYTMKTPNDANTTRYRHKSCYGDEMEAYPRTMGHKQHCNWDSIAHWNIVYMCQSGTWAINSKQNGHAQWNMNAEERWQGLHRPRLGIVKTLKTLEGLSVRTSFGIYQWTHYANRITMYVDIVDTPYKDWGKSFTMGNCMGRIPMMKAHRGSADNCNPLDPQGTHKVYMNSHASMGDRHFFPWHCSTHTLNTDHAAEASACTDPYPRWYPVPNFDTIHSWIHFFNNQNCELWAQHHIGIFHSIWKYPSSNLRYREQQFPNCIEGECAKCRSKIYYNMDIGFHRMLCYYQRNKCPRWLAMCQDQPLKDINNEGNGQPHCPAFEDSYRQWEMRIHHEPWEKANNLCEQAFNLFWNGRNLYQEVEMQLQANLEDRTSMWFRDAKPLIEKDVTFLNFCPMPPIAWPNLLFHCKFTKSNKHQYLILWPRTGLQMWPEAWHSPDEFWHTSLHYYMSGTETDWRAAIIGNCIVGWLRNQTQELAMCNPHFHLGHEWNLVQVDPWKKHHGKWDVTCRTLCEMYGTWSDHCRRSIQGLAGTNGVTFPSQNYCICWINRSQCCDGPIDPFDFTSHRQHYAIGGAFYPCCHQIYSDFYAIWKCCNPIVETKGHKYWCNDQFNPWAGTQMYITFELAGQGETVQQGAERNFLKTGHWMEPRFWNKRGSTIMSGMVNFIQNYQMCYRQLKAKVTFPGWHDGQRALFRGCDQQEFGCKGMRKVCLQFMVEMASFPRCERTAKCNTTKHDASWGVVWDAYYVATDVGWSQDFNCADGKMAYHMVLARYVLPVWAIHTHGTAQGHHDNMYHFQVCRRTRANCLCPSCDMMWYTHPEYNFQIFASQLSIFTNYRQLMYWTRFFMSDTMRCLLITSKRGYQSELDPMKWGTIPENQPTTRLLHFLMMGTDFNELNNWTMQVWAIFPNVINKIDSTWNELEQKWMSNLKEGNAIYCSSCEAAELARQMCYFRGHNTAWDDWMICETTKTGVHPIYHLCGTAVYNHKTQARHLHLNFQNMFAADDCQQAWKCWGMRKRMSCNTQDKRGTEAMVWFFENNVTATWNGRPKADWRQPINDSITYQSWNKWSMMILLWYTSADLLGFLNYRIGQAPYPWEVVLMCCNLVQNCFKPNWAHIAYFSYPWKYDVHEWSMGIPGPFEMMSREWQWSLSDFYKQPRNKIVSGQSNWIYIGNGIAYSQDYPYINSTIMGTIPCGRHMRTDIYHFYITACNEFDILDIDNWHIMKHHQCDMLTQSIPHKYCDVDALACITKRFVGQCWPITMWNFEHDMRGQEQSGHTGDLLEYPMHEKCKCYIVYHKLKAMHPQHTNLQSDKSRIPRKYWYPHNYYYQMCYYAGHDSTHLVHLLYAKVIGNYMCMWDLFNWNMWRPWFTAPAICKWGCHTGCQLMDWIQDCALYLMMFDIQISTKVDNWFTTFLDFSYVLPLAWDQPPRMVICTGNLMFQGQGAWYTSHCLCWHVHWWKVHRMDEVSQQDMQVPHNIFEVEMKICWPRDAMLPPRCVNRPVTNHDNSAILVWAITIVCSFGKTHESKIHHEGKSMGPPSHLHMRHEATMHVTNEFGFNMLWFSHWYEEDNFQTYHAMGNEMNTMMFHHRDNKPCARQQGCQYGNIPTGHKFMELMKLLRQVPTTEKMLLMHGIRVQEAGGTSWSKVWCFCRLHAKHLVPRPTQPDLKQDEGLPFCEIERQFDNLLVWYVHCYRWLSMSFWTCMGAFAWSLMSSNRITCLQNYSLFVAAHAMQKYAINYSCIMFNNWFCFKGPKSMVFHCHICYWINKSVCNGKWINQLDDTNFPGYHNIPWVQDDCPYNYKSEEFQSCRIIHNCWEYEAIPRDRLACDHSLVGFDHGHPEDAMWRFQNREWNTRGCLARHIWELPAVGVGCRWRKHMQAEKEIAQRCSHHESIDWKNGDVPCVDLSPPNDLLSQVSGDMHKFAPMPIRCKEPWRTHFKAHPPGERMYQGCELTGAVCNVGMMMPNKDKCRWICPPHIDWWVQQMCHFHIFCEDYYWDLGGTKGNVTCNPQYESQLGKIMELMAYHQMDHRHAVIWQEFTVFHMGVGPNRGVGCNMRGFRDFYWFGAMGSAPTLSMGFKISDEGVKTCVVTWCCWFEEHCVNRNMIDVTFYCATNDHKHQISPILRFPCRDWMAPHVLQMFDPAICLCPTVMDMPMGVWCWPTTKVTWEVWGCTVTGQMDMHKCCPEQEQWDNCRTKFKPIVIHGECQIYAVWCICQKMIRRTCQHDVHIQWQKSHGHCVCESDWVSVCGFPIKRWGWRCQFPMHWFCECKANTRRAIWHSRQYCERCKGNVQWWMWMYLWTQGQMPMQMHAADDELMPAVGWVELYAGHYTDDITRIQGQQGEAVGGFCVMNCHIDGKRDRPCIPGTDWRIWGYDEQERQYHMWRFPGQCVQMSRFKMTWNYETRRWFEWFMRMMPADIAVRDITKMNMCQKQSGARVVIELGYVDHYNPSGYFELTGEEQGMAHAEGERNHEFLRHMQKYYCCQKQRFSHYTMMKFKFFWGPVSPNYDWYLHSIMWPMEYVCSQPPLHPGKWDAQFLSIDLPPIVSHCEKSGYFYGCISYSKKLFIDNYFSYFNLYNPYICGCYCFGCDCTFLYMCESYDEEPWRLVKHAHIGEVGCATACIQKTCAGQIVCIPIQEFAWDWAAMDLEYSCDMRRRCVFYRGWNQVRQKPVYYIYPAEPEVRRTHIQHAVQLREDHEQYDTMIYFDKQLRTDYYPKVFSSYIYAFYCFLNPMCITNNDLQWWTCQCHHHEWMTERQARVEWQCVWRAATTQTFQYDPTMGRYCVLHFWHNQCFVTACQHTGLFMARAMMVEDEVYWWRCGYAGTDTDARADIKRCFDHYQPIGATHWGYEVCQEFSHTDREDENQLSGWTKGMNCGFIKPFDMIAYVETVRCSVEMPQQGSESVNNQGHKFMNVERRTNTMGRKCQENYQDQYMYARVATNDYGTHFISKDYQCGALCGIHIWGLVPANEHEICKDHCHSRNHMRHCVDDAIAMIDMWMSELFKAEGSISRPYNHTRGRWKAAQNLTYCFVWYHCRFPYLICRTWMSGQNNSFDMMTSMHYSIYDTYNVQLGLDPKNYHPPNRSANMVYIFHHNVEATNEREGFNVSMRAEIPIWEMKQEHDMVHCVDRRAQKWYCCYRKLVWEPGYLVKVGFWCPIETWDVYACADKKCCNKQPCRHECKGFTKLWIETECNNAHSTKWMTMPHVMIRTTFIKLHKVWGLENYGPEYGLNNICCREHFKMPDPENSGEDFHCGSRRDVSKMPIGCWHHLNDMYKNTQGIQSGGVAYVGRAQNPDFDNSNQRWDVRQGIDTNERRRTNGISAAQNYIVYDRGYTKRRPYHVSNHLQGFNAAWKVQWWGQMDGEIDSQDEYQASQNYYDLAVSSMANCISRIPHNYDHVPGIQSKMMDQRDTPVVPFVKSMVHGYQKDKIHFWAWKINIHLDYRWCPREKFNCGPNPKTGFKQQEIGMFIEAITWYFYWYDHQFWHMCVTTLDRRLLAARFDGIETMTSADLGHQWFYYYLMKGLLIGWIYNGIESDTHGLYMATMVYDAWCLEIRLWKHCISLLYFDEKRMIRYGKMHRNNEHGFDWKDTQTKMTLGYAQTESFCCLFCVVPVAGRVRGFMLHAPKWISGYDRKFKGDFPGKYPQGCWEWMLYCLHCGVSFDLEAKSQTPPGDYNPLLPDHQQGPENDHVRFWFAGGGEAYCNFRSAIKMCSYDANPWWHHLLLTWGMNISEKFKQWQHKIVHLRESQNCIDRAYQEAITSTLDRSKYRPLTRHLMEQFCHANRNLLISTSMWAHQIEGQLDNFWSFIYIGRYHIKEKWTCAIRRHQSGDPRLYPMCATTRVKEHVFMPKEWAPGDSWYNLQKRDGILSVPEQGTRSKIHIQKECKHGLNFDVAPPTLESCTKGRCICQTFAQWDKVQKKEWIAVFGVPGEASQPDNQKWDYQVKCDPIKFQHSIFPECEVDWYPRNPFIHNESPWTSTQWCSYAYGLKWGVRQVGAWTWSLYKVITDPTYPTGKMMQPVGMNIVCSKGFEDKAEWNEVNNVRTPYCGFCTKNYTDLATYIRMRMHICRWTLMTYGASGYCNQDVQRYSGAVSSYVGAGYVQPYFFEQFVQPGRGNVVQRRPAYNGLGLSPQEGEEPLSNAGIMKMIKEGCEITHIVEFINLIYFFAIQHSHWIPRMLLINQEHMRAIIYSRANEGWRRACTPNLRQPPHRTCIVPANTHPQEVVFTVSITKCWFLCWHSQDQVNEHIFGYIDSHRREDQAKPDMSEVMVLLGLTKDSENDFFCKWIKWGYWGMDPFHTMICHDEEKASIGYTLKVDLFHMCTTPFHTFVENSIHPKVQRDECIHRLHRPESHQELPQEMKDNLETAEGNYCAETMLMGACQVMEVKLYTSYRIKQNWRLCCGDINKLDTLLADPEYPCTMVNFWKQTIVWRIEDQINQCTKISHYWTFYANNKYGLFAEAHIPENREPQAVWKVLMGYFRFNWNDEQCFNPHRKCYAMQANVAERDQGKARIDFICEEYYTEPCYPGARDKRICRQEHKHNRLCCVVRHRNDPQVVGQDYVPDRMRKMFCLFIQGWSTRFSVTGHTPAYYDRYAYWIKNNGFWHCRHWQKATVQSQKYRICFNCVATEMSNMNNHWHVAQGTDDWEVPRAVHYVLCKAEHRYADEWFTIIVMAFHKCCKQVYVEMWQQHGDDVHVNAPINIHDEAAYCEWTVVMEVYEMAMCEPIVIKRCEWAGCDGFHNTIYDTTWVVSQAITNVLESIMSWYGTSWRYPQGIFNYHTHMRDRVPWYGMCPLSLEEVEPHNNRNEKPGLPDCQIAAQSWEMKDIACYCPPHCFILTLHYTLKISHWTHAIGTWCEGPKMISFVTHYGQHWNNDTGILEVKISWQCARCGQAFLDRELEVTNRYMDYVFRNKCWVYGYKWESEDQYKSKLYVSEAGCNFWSHVCAYKNNIAPFITHPRRAKLYPNHTLQIIILRIWWGNRDGHRHLPEGYINQWHAPRQVCAINHIGHHAGMWCHCDWCKYFACYQKYVSIWQDERLCEEAIIRIEDMEDITFLINRGDGRCVKQERMPDTRRDRAKEEHSDCLWCSYAPWMLTSAQPCGCEANQSNYTYHSMQANWACFPRGVPVYHDMISSDDNVFHIVVNVIYTEFEMIAKKVFVKKAIRNWEGTQLVPWSVPLNDDELLILFKNLRTDVISQTLGFDIMRNLSKNFSVDTVTMHPLQQYTPAVWSEKSFEPLQMRMSQAANQAKTNWCRWAPHPPAWNAFLLFSGVARNKAQYRCGSHVTPWSLFSWADILNTGYDYCELPDMQMFTRFPQNQSLHKCGWDLPRMFTTIQWFYAIDWKNLRRQVYMLNDTGSNQVFSWMTNPLQNQKNKNAHFQVHGTTQPVKLEDPPQSTQASRHGSQCNCIVSQPWRGQCAFECDVLKFPQFRVMSMKAYIYMFQKHTQGEMKIMNLVWRFTLVHQKMQKAVCSTETMHVNWDGFAKIDPASWLMDILPANIHWGFVFYDRCYSERWRLDMETEPIRHTCRTDERFLDTDGMHSVFMQMVYNCCSVGWSFSYDHSRLRIDHNDVRTPERDSASLSNMFLIQMCQIQGSWMYYFHAWIWDDHEYNIPVFPYEGPNPLAMIQLQLSMPNPGVGHVYGSAGHLFQSGEQHRGTHQWGAFGKDTPNQTMTLAMSKTTIGEVYRKWYTYYKWVKDTKLEHLRTIGQRRWNMFNISVICKSRDLNNGDVQIPPDPQGNIRLKPSSTANKACLITFGMTATHMSTAQWKNVNQRVKTPYKRWPQDYSATCIYWIKCDLNAANMHSLWWMMFLSQHNFWDRLIDWCAWAWAFWCTGSKTHELDEAPWVTLWNMNMCGEHLCKFYRFQDDISGRAGGKFGPPWSSYMTPWQMCASKFKMLAYPSADQEWEQDHAFWKSRRMDRQVVRYQQCGLMWIYSAILDNWVDQILYTPLEIYGPKHDITENNEHGMQDCMRTNNWTQLRAKKEQFDFTDNEMAEGFIKWWGIPRHCKNQLADRYQGQAIQQWYCNQCTSFEYMTTCARSEYFNINCVTACQSDSLMNVGCEGGKNYMHDIRCNVGRGSWQYLATFFHLMAEMIMMWWIWKWIPPASDHMIHHMWEIHCPNFCDRPNWESEQATQYFPTPNFIKLKCATIIECKWQMDKLSWMDYKFGFFDICPSAGGYAIQFTEYEGITNNDLQLWFKFPMNHVQNIGEGTQGRLSCAIHASNWDLYSMYRKCLESYHDPAHNWSGRLENQHPGDLYHTHHGMCSDWSSFGFAKVNYDKQQASWHIGRIFNFGLHEKIQIKIIPWYVRFVQKPTCSGIHYHNVMVWMLWIEQAHSEFKCEPLMNVNPDVCHDFMCTVDCLKTSMKCVLTDMGQECLIQAWWFVKVDETYMGDATDSRERCAHYEQNIYVKCRRYIQHIHCDDCQGLFIIFYAGIAEITMQWRMDAPIPNLNGMICSIKADWSGFTDEICSQT"

aligned_v, aligned_w = Hirschberg(v, w)
final_score = score_alignment(aligned_v, aligned_w)

print(final_score)
print(aligned_v)
print(aligned_w)
